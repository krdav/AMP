
# This can be used as an executable to install all dependencies:
# ./INSTALL

# Install conda environment:
conda create -y -n SPURF
source activate SPURF  # do this _every_ time you start a new terminal
mkdir -p $CONDA_PREFIX/etc/conda/activate.d
mkdir -p $CONDA_PREFIX/etc/conda/deactivate.d
printf '#!/bin/sh\n\nexport PYTHONNOUSERSITE=1' > $CONDA_PREFIX/etc/conda/activate.d/env_vars.sh
printf '#!/bin/sh\n\nunset PYTHONNOUSERSITE' > $CONDA_PREFIX/etc/conda/deactivate.d/env_vars.sh

source activate SPURF
conda install -y -c anaconda gxx_linux-64
conda install -y biopython cmake gsl openblas pandas psutil pysam r-essentials scons seaborn
conda install -y -c biocore mafft
conda install -y -c r r-rcpparmadillo
pip install colored-traceback dendropy==3.12.3

source activate SPURF
conda config --add channels r
conda config --add channels bioconda
conda update -y pysam
conda install -y pyyaml

# R modules to install:
R CMD BATCH modules2install.R

# Install ANARCI for making AHo annotations:
echo 'Installing ANARCI. Important: HMMER3 is required!!!'
cd ANARCI_KD_copy
python setup.py install --user
cd ..

# Install partis for inferring VDJ annotation and naive sequence:
cd partis
./bin/build.sh
cd ..
